# Knowledge Base FAQ

## Where is the text stored?

### Current Implementation: **In-Memory Storage**

All knowledge base data is stored in the browser's memory (RAM) in the `ragService` object. This means:

- ‚úÖ **Fast access** - No database queries needed
- ‚úÖ **Privacy** - Nothing stored on servers
- ‚ùå **Temporary** - Lost when you refresh the page
- ‚ùå **Session-only** - Doesn't persist between browser sessions

### Storage Location in Code
```
ragService.knowledgeBase (private array)
  ‚îî‚îÄ‚îÄ KnowledgeDocument[]
      ‚îú‚îÄ‚îÄ id: string
      ‚îú‚îÄ‚îÄ content: string
      ‚îú‚îÄ‚îÄ metadata: { type, source, tibetan, etc. }
      ‚îî‚îÄ‚îÄ embedding?: number[] (vector)
```

## How to View What's in the Knowledge Base

### Option 1: View All Documents (NEW!)
1. Open **Rigpa AI** chat
2. Click **üß† Knowledge Base** button
3. Click **üìã View All Documents**
4. Filter by:
   - **All** - Everything in the KB
   - **Terms** - Dzogchen terms only
   - **Custom Texts** - User-added content

### Option 2: Test Search
1. In Knowledge Base Manager
2. Go to **Test Knowledge Retrieval** section
3. Enter a query (e.g., "rigpa")
4. See the top 5 matching documents

### Option 3: Check Statistics
The Status section shows:
- **Total Documents**: Count of all items
- **With Embeddings**: How many have vector embeddings
- **Initialized**: Whether KB is ready

## What Gets Stored?

### 1. Dzogchen Terms (248 documents)
When you click "Initialize Now":
```
Format: {transliteration} ({tibetan}, {wiley}): {translation}
Example: "rigpa (‡Ω¢‡Ω≤‡ΩÇ‡ºã‡Ωî, rig pa): Pure awareness, knowledge"
Type: 'term'
```

### 2. Custom Text Resources
When you add custom text:
```
Format: Whatever text you paste
Type: 'text'
Source: 'user-added'
ID: 'custom-{timestamp}'
```

### 3. Embeddings (vectors)
If you have an API key:
- Each document gets a 1536-dimension vector
- Used for semantic similarity search
- Generated by OpenAI's text-embedding-3-small model

## Managing Documents

### Add Custom Text
1. Open Knowledge Base Manager
2. Scroll to "Add Custom Text Resources"
3. Paste your text
4. Click "Add Text to Knowledge Base"

### Delete Custom Text
1. Click **üìã View All Documents**
2. Find the custom text (type: 'text')
3. Click the üóëÔ∏è delete button
4. Confirm deletion

**Note**: You cannot delete Dzogchen terms (built-in data)

### Clear Everything
1. Scroll to **‚ö†Ô∏è Danger Zone**
2. Click "Clear Knowledge Base"
3. Confirm (this cannot be undone)
4. Re-initialize to start fresh

## Future: Persistent Storage

To keep data between sessions, we could add:

### Option A: localStorage
```typescript
// Save to browser storage
localStorage.setItem('knowledgeBase', JSON.stringify(documents));

// Load on startup
const saved = localStorage.getItem('knowledgeBase');
```
**Pros**: Simple, no server needed
**Cons**: 5-10MB limit, embeddings might be too large

### Option B: IndexedDB
```typescript
// Browser database for large datasets
const db = await openDB('rigpa-kb', 1);
await db.put('documents', documents);
```
**Pros**: Can store large amounts (50MB+)
**Cons**: More complex API

### Option C: Server Database
Save to a real database (MongoDB, PostgreSQL, etc.)
**Pros**: True persistence, accessible anywhere
**Cons**: Requires backend infrastructure

## Quick Commands

### View Everything
```
Knowledge Base Manager ‚Üí View All Documents ‚Üí Filter: All
```

### View Only Custom Texts
```
Knowledge Base Manager ‚Üí View All Documents ‚Üí Filter: Custom Texts
```

### Find Specific Term
```
Knowledge Base Manager ‚Üí Test Knowledge Retrieval ‚Üí Enter term ‚Üí Search
```

### Check What's Loaded
```
Knowledge Base Manager ‚Üí Status section ‚Üí Total Documents
```

## Common Questions

**Q: Why does the count reset when I refresh?**  
A: Everything is in-memory only. You need to re-initialize after each page load.

**Q: Can I export the knowledge base?**  
A: Not yet, but we could add JSON export/import functionality.

**Q: How much can I store?**  
A: Theoretically unlimited in memory, but browser performance may degrade with 10,000+ documents.

**Q: Can I upload a file instead of pasting text?**  
A: Not yet, but we could add file upload (.txt, .md, .pdf) support.

**Q: Where are embeddings stored?**  
A: In the same in-memory array, as a `number[]` property on each document.

---

**Want persistent storage?** Let me know and I can implement localStorage or IndexedDB!
